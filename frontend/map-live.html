<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live OSM Map - Axes Systems</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="styles/map-live.css">
</head>

<body>
    <header>
        <h1>üåç Axes Systems - Live OSM Displacement</h1>
        <a href="index.html" class="nav-back">‚Üê Back to Dashboard</a>
    </header>

    <div class="app-container">
        <div class="sidebar">
            <div class="panel-box">
                <h3>1. Select Area</h3>
                <div class="instruction">
                    <div class="step">
                        <span class="num">1</span>
                        <span>Click map for <strong>Point A</strong></span>
                    </div>
                    <div class="step">
                        <span class="num">2</span>
                        <span>Click map for <strong>Point B</strong></span>
                    </div>
                    <div class="step">
                        <span class="num">3</span>
                        <span>Click <strong>Fetch & Analyze</strong></span>
                    </div>
                </div>
            </div>

            <div class="panel-box">
                <h3>2. Controls</h3>
                <div id="point-a" class="point-info">Point A: Not set</div>
                <div id="point-b" class="point-info">Point B: Not set</div>
                <button id="btn-fetch" class="btn-primary" disabled>Fetch & Displace</button>
                <button id="btn-reset" class="btn-secondary">Reset</button>
                <div class="traffic-toggle-row">
                    <span class="traffic-label">Show Live Traffic</span>
                    <label class="toggle-pill">
                        <input type="checkbox" id="traffic-toggle" autocomplete="off" />
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <div class="panel-box">
                <h3>3. Comprehensive Metrics</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="value" id="stat-overlaps">0</div>
                        <div class="label">Overlaps Found</div>
                    </div>
                    <div class="stat-item">
                        <div class="value" id="stat-resolved">0</div>
                        <div class="label">Conflicts Fixed</div>
                    </div>
                    <div class="stat-item">
                        <div class="value" id="stat-max-shift">0.0m</div>
                        <div class="label">Max Shift</div>
                    </div>
                    <div class="stat-item">
                        <div class="value" id="stat-features">0</div>
                        <div class="label">Total Features</div>
                    </div>
                    <div class="stat-item">
                        <div class="value" id="stat-iterations">5</div>
                        <div class="label">Iterations</div>
                    </div>
                    <div class="stat-item">
                        <div class="value" id="stat-time">-</div>
                        <div class="label">Process Time</div>
                    </div>
                </div>
            </div>

            <div class="panel-box">
                <h3>Features & Priorities (WHY?)</h3>
                <div class="legend-row">
                    <span class="legend-prio">Priority 1</span>
                    <span style="flex: 1; margin-left: 8px;">Highway (25m)</span>
                    <div class="legend-line" style="background:#E63946"></div>
                </div>
                <div class="legend-desc">WHY: Critical infrastructure - never moves</div>
                
                <div class="legend-row" style="margin-top: 8px;">
                    <span class="legend-prio">Priority 2</span>
                    <span style="flex: 1; margin-left: 8px;">Primary (20m)</span>
                    <div class="legend-line" style="background:#F4A261"></div>
                </div>
                <div class="legend-desc">WHY: Main roads - fixed position</div>
                
                <div class="legend-row" style="margin-top: 8px;">
                    <span class="legend-prio">Priority 3</span>
                    <span style="flex: 1; margin-left: 8px;">Secondary (15m)</span>
                    <div class="legend-line" style="background:#E9C46A"></div>
                </div>
                <div class="legend-desc">WHY: Can be displaced to avoid overlap</div>
                
                <div class="legend-row" style="margin-top: 8px;">
                    <span class="legend-prio">Priority 4</span>
                    <span style="flex: 1; margin-left: 8px;">Water (20m)</span>
                    <div class="legend-line" style="background:#4A90D9"></div>
                </div>
                <div class="legend-desc">WHY: Rivers can shift for clarity</div>
                
                <div class="legend-row" style="margin-top: 8px;">
                    <span class="legend-prio">Priority `5</span>
                    <span style="flex: 1; margin-left: 8px;">Other (8m)</span>
                    <div class="legend-line" style="background:#888888"></div>
                </div>
                <div class="legend-desc">WHY: Most flexible features</div>
            </div>
        </div>

        <div class="map-area">
            <div class="map-tabs">
                <div class="map-tab active" data-view="select">Select Area</div>
                <div class="map-tab" data-view="before">Before <span class="badge">Overlap</span></div>
                <div class="map-tab" data-view="after">After <span class="badge">Fixed</span></div>
            </div>

            <div id="view-select" class="map-view active">
                <div id="map-select" style="height: 100%;"></div>
                <div class="coord-display">
                    <span id="coord-select-lat">Lat: --</span>
                    <span id="coord-select-lng">Lng: --</span>
                </div>
            </div>
            <div id="view-before" class="map-view">
                <div id="map-before" style="height: 100%;"></div>
                <div class="coord-display">
                    <span id="coord-before-lat">Lat: --</span>
                    <span id="coord-before-lng">Lng: --</span>
                </div>
            </div>
            <div id="view-after" class="map-view">
                <div id="map-after" style="height: 100%;"></div>
                <div class="coord-display">
                    <span id="coord-after-lat">Lat: --</span>
                    <span id="coord-after-lng">Lng: --</span>
                </div>
            </div>
        </div>
    </div>

    <div id="loading" class="loading-overlay">
        <div class="spinner"></div>
        <div style="margin-top:15px; color:#aaa">Processing Vector Data...</div>
    </div>

    <div id="toast" class="toast">Analysis Complete</div>

    <script src="js/map-live.js"></script>
</body>

</html>
